<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>If√° Soundscape ‚Äì Advanced Full Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            transition: background-image 1s ease-in-out;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            z-index: -1;
            pointer-events: none;
        }
        .glass-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .audio-player {
            width: 100%;
            margin: 10px 0;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.1);
        }
        .control-group {
            margin-bottom: 15px;
        }
        .control-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #f59e0b;
        }
        .control-group select, .control-group input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.9);
            color: #374151;
        }
        .play-button {
            background: linear-gradient(45deg, #f59e0b, #d97706);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 10px;
        }
        .play-button:hover {
            background: linear-gradient(45deg, #d97706, #b45309);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
        }
        .stop-button {
            background: #dc2626;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .timer-button {
            background: #374151;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-left: 10px;
        }
        .info-panel {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-left: 4px solid #f59e0b;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }
        .info-panel h3 {
            color: #f59e0b;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .prayer-text {
            background: rgba(245, 158, 11, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #f59e0b;
            margin: 20px 0;
            font-style: italic;
            color: white;
        }
        .yoruba {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 10px;
            font-weight: 600;
        }
        .translation {
            font-size: 0.95em;
            opacity: 0.8;
            line-height: 1.5;
        }
        .status-display {
            text-align: center;
            font-style: italic;
            color: #f59e0b;
            margin: 15px 0;
            padding: 10px;
            background: rgba(245, 158, 11, 0.1);
            border-radius: 6px;
        }
    </style>
</head>
<body class="p-6 text-white">
    <div class="max-w-4xl mx-auto glass-container p-8">
        <h1 class="text-3xl font-bold text-center mb-6 text-yellow-400">
            üåø If√° Soundscape ‚Äì Advanced Full Experience
        </h1>

        <!-- Traditional Prayer Section -->
        <div class="prayer-text">
            <div class="yoruba">
                <strong>Or√≠ mi d√° mi l√≥r√≠,</strong><br>
                <strong>·ªåÃÄrunm√¨l√†, j·ªçÃÄw·ªçÃÅ d√° mi l√≥r√≠.</strong><br>
                <strong>Mo b·∫πÃÄ If√°, k√≠ ·ªçj·ªçÃÅ mi d√°a l√≥n√¨√≠.</strong><br><br>
                <strong>Or√≠ ire, gb√† mi l'·ªçÃÅj·ªçÃÅ rere.</strong><br>
                <strong>·ªåÃÄ·π£un, al√°r√≤y√®, f√∫n mi n√≠ √†·π£·∫π √†t·ªçÃÅk√†nw√°.</strong><br>
                <strong>If√°, fi √†y·ªçÃÄ b√≥ mi l√°rug·∫π.</strong><br>
                <strong>·ªåd√∫n y√¨√≠ ni mo m√°a r√≠ √¨b√πk√∫n.</strong>
            </div>
            <div class="translation">
                <em>My head blesses me, ·ªåÃÄrunm√¨l√†, please guide me.<br>
                I call on If√°, that my day be good today.<br>
                Good head, carry me into a blessed day.<br>
                ·ªåÃÄ·π£un, bringer of wealth, grant me divine favor.<br>
                If√°, wrap me in joy and success.<br>
                This year, I will walk in blessings.</em>
            </div>
        </div>

        <!-- Audio Layer Controls -->
        <div class="grid md:grid-cols-3 gap-6 mb-6">
            <div class="control-group">
                <label for="layer1Select">üéµ Layer 1 (Primary - Chant/Drum)</label>
                <select id="layer1Select">
                    <option value="ifa_wisdom_chant">If√° Wisdom Chant</option>
                    <option value="ifa_prosperity_chant">If√° Prosperity Chant</option>
                    <option value="talking_drum_loop">Talking Drum</option>
                    <option value="bata_egungun_abida">Bat√° Drum ‚Äì Egungun Ceremony</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="layer2Select">üåä Layer 2 (Nature Ambience)</label>
                <select id="layer2Select">
                    <option value="ocean_blessing_waves">Ocean Blessing Waves</option>
                    <option value="sacred_forest">Sacred Forest</option>
                    <option value="flowing_river">Flowing River</option>
                    <option value="temple_peace">Temple Peace</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="orikiSelect">üëë Layer 3 (Optional Or√≠k√¨ Overlay)</label>
                <select id="orikiSelect">
                    <option value="">None</option>
                    <option value="oriki_sango">Or√≠k√¨ ·π¢√†ng√≥</option>
                    <option value="oriki_orunmila">Or√≠k√¨ √ír√∫nm√¨l√†</option>
                    <option value="oriki_obatala">Or√≠k√¨ ·ªåb√†t√°l√°</option>
                    <option value="oriki_ogun">Or√≠k√¨ √íg√∫n</option>
                </select>
            </div>
        </div>

        <!-- Advanced Controls -->
        <div class="grid md:grid-cols-4 gap-4 mb-6">
            <div class="control-group">
                <label for="bataOffset">‚è± Drum Sync Offset (sec)</label>
                <input type="number" id="bataOffset" value="0" step="0.1" min="0" max="5" />
            </div>
            
            <div class="control-group">
                <label for="layer1Volume">üîä Layer 1 Volume</label>
                <input type="range" id="layer1Volume" min="0" max="100" value="80" />
            </div>
            
            <div class="control-group">
                <label for="layer2Volume">üîä Layer 2 Volume</label>
                <input type="range" id="layer2Volume" min="0" max="100" value="50" />
            </div>
            
            <div class="control-group">
                <label for="layer3Volume">üîä Layer 3 Volume</label>
                <input type="range" id="layer3Volume" min="0" max="100" value="60" />
            </div>
        </div>

        <!-- Sleep Timer -->
        <div class="control-group mb-6">
            <label for="sleepMinutes">‚è≤Ô∏è Sleep Timer (Auto-stop after X minutes)</label>
            <div class="flex items-center gap-4">
                <input type="number" id="sleepMinutes" min="1" max="120" placeholder="Minutes" class="w-32" />
                <button onclick="setSleepTimer()" class="timer-button">Set Timer</button>
                <span id="timerStatus" class="text-sm text-yellow-300"></span>
            </div>
        </div>

        <!-- Playback Controls -->
        <div class="text-center mb-6">
            <button onclick="playLayeredSound()" class="play-button">
                ‚ñ∂Ô∏è Play Layered Experience
            </button>
            <button onclick="stopAll()" class="stop-button">
                ‚èπ Stop All Layers
            </button>
        </div>

        <!-- Audio Players Grid -->
        <div class="grid md:grid-cols-3 gap-6 mb-6">
            <div>
                <label class="block text-yellow-300 mb-2">Layer 1 Audio:</label>
                <audio id="layer1Audio" controls class="audio-player"></audio>
            </div>
            <div>
                <label class="block text-yellow-300 mb-2">Layer 2 Audio:</label>
                <audio id="layer2Audio" controls class="audio-player"></audio>
            </div>
            <div>
                <label class="block text-yellow-300 mb-2">Layer 3 Audio:</label>
                <audio id="orikiAudio" controls class="audio-player"></audio>
            </div>
        </div>

        <!-- Status Display -->
        <div id="nowPlaying" class="status-display"></div>

        <!-- Sound Information Panel -->
        <div id="infoPanel" class="info-panel">
            <h3 id="infoTitle"></h3>
            <p><strong>Spiritual Role:</strong> <span id="infoRole"></span></p>
            <p><strong>Traditional Use:</strong> <span id="infoUse"></span></p>
            <p><strong>Energy Quality:</strong> <span id="infoEnergy"></span></p>
            <p><strong>Cultural Context:</strong> <span id="infoContext"></span></p>
        </div>

        <!-- Preset Combinations -->
        <div class="mb-6">
            <h3 class="text-xl font-semibold text-yellow-300 mb-4">üé≠ Sacred Preset Combinations</h3>
            <div class="grid md:grid-cols-3 gap-4">
                <button onclick="loadPreset('ancestral')" class="preset-button bg-purple-600 hover:bg-purple-700 text-white p-4 rounded-lg">
                    üëª Ancestral Communion<br>
                    <small>Egungun + Forest</small>
                </button>
                <button onclick="loadPreset('healing')" class="preset-button bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-lg">
                    üåä Divine Healing<br>
                    <small>Ocean + Wisdom</small>
                </button>
                <button onclick="loadPreset('prosperity')" class="preset-button bg-green-600 hover:bg-green-700 text-white p-4 rounded-lg">
                    üí∞ Abundance Ritual<br>
                    <small>Prosperity + River</small>
                </button>
            </div>
        </div>

        <!-- Keyboard Shortcuts Info -->
        <div class="text-center text-sm text-gray-300">
            <p><strong>Keyboard Shortcuts:</strong> Space = Play/Pause | Escape = Stop All | Ctrl+S = Set Timer</p>
        </div>
    </div>

    <script>
        // Audio file mappings - Update these paths to your actual audio files
        const audioMap = {
            ifa_wisdom_chant: "/static/audio/soundscapes/ifa_wisdom_chant.mp3",
            ifa_prosperity_chant: "/static/audio/soundscapes/ifa_prosperity_chant.mp3",
            talking_drum_loop: "/static/audio/soundscapes/talking_drum_loop.mp3",
            ocean_blessing_waves: "/static/audio/soundscapes/ocean_blessing_waves.mp3",
            sacred_forest: "/static/audio/soundscapes/sacred_forest.mp3",
            flowing_river: "/static/audio/soundscapes/flowing_river.mp3",
            temple_peace: "/static/audio/soundscapes/temple_peace.mp3",
            bata_egungun_abida: "/static/audio/soundscapes/bata_egungun_abida.mp3",
            oriki_sango: "/static/audio/soundscapes/oriki_sango.mp3",
            oriki_orunmila: "/static/audio/soundscapes/oriki_orunmila.mp3",
            oriki_obatala: "/static/audio/soundscapes/oriki_obatala.mp3",
            oriki_ogun: "/static/audio/soundscapes/oriki_ogun.mp3"
        };

        // Background image mappings
        const backgroundMap = {
            ifa_wisdom_chant: "/static/images/backgrounds/chant_background.jpg",
            ifa_prosperity_chant: "/static/images/backgrounds/prosperity_background.jpg",
            talking_drum_loop: "/static/images/backgrounds/drum_background.jpg",
            bata_egungun_abida: "/static/images/backgrounds/drum_background.jpg",
            ocean_blessing_waves: "/static/images/backgrounds/ocean_background.jpg",
            sacred_forest: "/static/images/backgrounds/forest_sacred.jpg",
            flowing_river: "/static/images/backgrounds/ocean_background.jpg",
            temple_peace: "/static/images/backgrounds/temple_peace.jpg"
        };

        // Detailed sound information
        const soundDetails = {
            bata_egungun_abida: {
                title: "Bat√° Drum ‚Äì Egungun Ceremony",
                role: "Calls ancestral spirits in traditional Yoruba ceremonies",
                use: "Used in Egungun festivals and sacred processions",
                energy: "Deep, rhythmic, ceremonial grounding",
                context: "Sacred drums that speak the language of the ancestors, connecting the living with those who have passed"
            },
            ifa_wisdom_chant: {
                title: "If√° Wisdom Chant",
                role: "Spiritual invocation of clarity and divine knowledge",
                use: "Recited during early morning prayer or divination",
                energy: "Reflective, uplifting, mentally awakening",
                context: "Traditional verses that open the mind to receive divine wisdom and guidance from √ír√∫nm√¨l√†"
            },
            ifa_prosperity_chant: {
                title: "If√° Prosperity Chant",
                role: "Invocation for abundance and material blessings",
                use: "Chanted during wealth attraction rituals",
                energy: "Empowering, manifesting, abundant",
                context: "Sacred words that align practitioners with the flow of abundance and prosperity"
            },
            talking_drum_loop: {
                title: "Talking Drum (D√πnd√∫n)",
                role: "Traditional communication and rhythm keeper",
                use: "Storytelling, ceremonies, and spiritual communication",
                energy: "Melodic, conversational, connecting",
                context: "The voice of the drum that mimics Yoruba speech patterns, carrying messages across realms"
            },
            ocean_blessing_waves: {
                title: "Ocean Blessing Waves",
                role: "Channeling Yemoja's maternal divine energy",
                use: "Healing ceremonies, emotional cleansing, fertility rituals",
                energy: "Nurturing, flowing, cleansing",
                context: "The sound of the great mother Yemoja, whose waters heal and purify the soul"
            },
            sacred_forest: {
                title: "Sacred Forest (Igb√≥ M√≠m·ªçÃÅ)",
                role: "Connection to earth spirits and natural forces",
                use: "Meditation, herb gathering, nature-based healing",
                energy: "Grounding, mystical, peaceful",
                context: "The sacred groves where Orishas dwell and spiritual initiations take place"
            }
        };

        // Preset combinations
        const presets = {
            ancestral: {
                layer1: "bata_egungun_abida",
                layer2: "sacred_forest",
                layer3: "",
                offset: 1.5
            },
            healing: {
                layer1: "ifa_wisdom_chant",
                layer2: "ocean_blessing_waves",
                layer3: "",
                offset: 0
            },
            prosperity: {
                layer1: "ifa_prosperity_chant",
                layer2: "flowing_river",
                layer3: "",
                offset: 0
            }
        };

        let sleepTimer = null;
        let isPlaying = false;

        function setBackgroundImage(soundKey) {
            const imageUrl = backgroundMap[soundKey];
            if (imageUrl) {
                document.body.style.backgroundImage = `url('${imageUrl}')`;
            }
        }

        function showSoundInfo(soundKey) {
            const info = soundDetails[soundKey];
            if (info) {
                document.getElementById('infoTitle').textContent = info.title;
                document.getElementById('infoRole').textContent = info.role;
                document.getElementById('infoUse').textContent = info.use;
                document.getElementById('infoEnergy').textContent = info.energy;
                document.getElementById('infoContext').textContent = info.context;
                document.getElementById('infoPanel').style.display = 'block';
            }
        }

        function updateVolumeControls() {
            const a1 = document.getElementById("layer1Audio");
            const a2 = document.getElementById("layer2Audio");
            const a3 = document.getElementById("orikiAudio");
            
            a1.volume = document.getElementById("layer1Volume").value / 100;
            a2.volume = document.getElementById("layer2Volume").value / 100;
            a3.volume = document.getElementById("layer3Volume").value / 100;
        }

        function playLayeredSound() {
            const l1 = document.getElementById("layer1Select").value;
            const l2 = document.getElementById("layer2Select").value;
            const l3 = document.getElementById("orikiSelect").value;
            const offset = parseFloat(document.getElementById("bataOffset").value || "0");

            const a1 = document.getElementById("layer1Audio");
            const a2 = document.getElementById("layer2Audio");
            const a3 = document.getElementById("orikiAudio");

            // Set audio sources
            a1.src = audioMap[l1];
            a2.src = audioMap[l2];
            if (l3) a3.src = audioMap[l3];

            // Apply volume controls
            updateVolumeControls();

            // Set looping for continuous experience
            a2.loop = true;
            if (l3) a3.loop = true;

            // Play layers with timing
            a1.play().catch(e => console.log("Layer 1 failed:", e));
            
            // Apply drum offset timing
            if (l2.includes('bata') || l2.includes('drum')) {
                setTimeout(() => a2.play().catch(e => console.log("Layer 2 failed:", e)), offset * 1000);
            } else {
                a2.play().catch(e => console.log("Layer 2 failed:", e));
            }
            
            if (l3) {
                setTimeout(() => a3.play().catch(e => console.log("Layer 3 failed:", e)), 2000);
            }

            // Update display
            setBackgroundImage(l1);
            showSoundInfo(l1);
            updateNowPlaying(l1, l2, l3, offset);
            
            isPlaying = true;
            
            // Update button
            const button = document.querySelector('.play-button');
            button.textContent = 'üéµ Playing Layered Experience...';
            button.style.background = 'linear-gradient(45deg, #22c55e, #16a34a)';
        }

        function updateNowPlaying(l1, l2, l3, offset) {
            let text = `üéµ Playing: ${l1.replace(/_/g, ' ')} + ${l2.replace(/_/g, ' ')}`;
            if (l3) text += ` + ${l3.replace(/_/g, ' ')}`;
            if (offset > 0) text += ` (${offset}s offset)`;
            document.getElementById('nowPlaying').textContent = text;
        }

        function setSleepTimer() {
            const minutes = parseInt(document.getElementById('sleepMinutes').value);
            if (minutes && minutes > 0) {
                if (sleepTimer) clearTimeout(sleepTimer);
                
                sleepTimer = setTimeout(() => {
                    stopAll();
                    document.getElementById('nowPlaying').textContent = 'üò¥ Sleep timer activated - all audio stopped';
                    document.getElementById('timerStatus').textContent = '';
                }, minutes * 60 * 1000);
                
                document.getElementById('timerStatus').textContent = `Timer set for ${minutes} minutes`;
                setTimeout(() => {
                    document.getElementById('timerStatus').textContent = '';
                }, 3000);
            }
        }

        function stopAll() {
            const a1 = document.getElementById("layer1Audio");
            const a2 = document.getElementById("layer2Audio");
            const a3 = document.getElementById("orikiAudio");
            
            [a1, a2, a3].forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });
            
            if (sleepTimer) {
                clearTimeout(sleepTimer);
                sleepTimer = null;
            }
            
            isPlaying = false;
            
            const button = document.querySelector('.play-button');
            button.textContent = '‚ñ∂Ô∏è Play Layered Experience';
            button.style.background = 'linear-gradient(45deg, #f59e0b, #d97706)';
            
            document.getElementById('nowPlaying').textContent = '';
            document.getElementById('timerStatus').textContent = '';
        }

        function loadPreset(presetName) {
            const preset = presets[presetName];
            if (preset) {
                document.getElementById('layer1Select').value = preset.layer1;
                document.getElementById('layer2Select').value = preset.layer2;
                document.getElementById('orikiSelect').value = preset.layer3;
                document.getElementById('bataOffset').value = preset.offset;
                
                // Auto-play the preset
                setTimeout(() => playLayeredSound(), 500);
            }
        }

        // Enhanced event listeners
        document.getElementById('layer1Select').addEventListener('change', function() {
            setBackgroundImage(this.value);
            showSoundInfo(this.value);
        });

        // Volume control listeners
        ['layer1Volume', 'layer2Volume', 'layer3Volume'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateVolumeControls);
        });

        // Enhanced keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space') {
                e.preventDefault();
                if (isPlaying) {
                    stopAll();
                } else {
                    playLayeredSound();
                }
            }
            if (e.code === 'Escape') {
                stopAll();
            }
            if (e.code === 'KeyS' && e.ctrlKey) {
                e.preventDefault();
                setSleepTimer();
            }
        });

        // Initialize with first sound info
        document.addEventListener('DOMContentLoaded', function() {
            const firstSound = document.getElementById('layer1Select').value;
            showSoundInfo(firstSound);
            setBackgroundImage(firstSound);
        });
    </script>
</body>
</html>